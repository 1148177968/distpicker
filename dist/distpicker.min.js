/*!
 * Distpicker v0.1.0
 * https://github.com/fengyuanchen/distpicker
 *
 * Copyright 2014 Fengyuan Chen
 * Released under the MIT license
 */

!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(window.jQuery)}(function(a){"use strict";function b(c,d){d=a.isPlainObject(d)?d:{},this.$element=a(c),this.defaults=a.extend({},b.defaults,d),this.init()}if("undefined"==typeof ChineseDistricts)throw new Error('The file "distpicker.data.js" must be included first!');b.defaults={province:"—— 省 ——",city:"—— 市 ——",district:"—— 区 ——"},b.prototype={constructor:b,data:ChineseDistricts,init:function(){var b=this.$element.find("select"),c=b.length,d={};b.each(function(){a.extend(d,a(this).data())}),d.province?(this.defaults.province=d.province,this.$province=b.filter("[data-province]")):this.$province=c>0?b.eq(0):null,d.city?(this.defaults.city=d.city,this.$city=b.filter("[data-city]")):this.$city=c>1?b.eq(1):null,d.district?(this.defaults.district=d.district,this.$district=b.filter("[data-district]")):this.$district=c>=2?b.eq(2):null,this.output("province"),this.output("city"),this.output("district"),this.addListener()},addListener:function(){var a=this;this.$province&&this.$province.change(function(){a.output("city"),a.output("district")}),this.$city&&this.$city.change(function(){a.output("district")})},output:function(b){var c=1,d={},e=[],f="",g=this["$"+b],h=this;g&&(f=this.defaults[b]||"",c="province"===b?1:"city"===b?this.$province.find("option:selected").data().zipcode:"district"===b?this.$city.find("option:selected").data().zipcode:c,d=a.isNumeric(c)?this.data[c]:{},a.each(d,function(a,b){var c=b===f;c&&(h.selected=!0),e.push(h.template({zipcode:a,address:b,selected:c}))}),this.selected||e.unshift(h.template({zipcode:"",address:f,selected:!1})),g.html(e.join("")))},template:function(b){var c={zipcode:"",address:"",selected:!1};return a.extend(c,b),['<option value="'+(c.address&&c.zipcode?c.address:"")+'"',' data-zipcode="'+(c.zipcode?c.zipcode:"")+'"',c.selected?" selected":"",">"+(c.address?c.address:"")+"</option>"].join("")}},a.fn.distpicker=function(c){return this.each(function(){a(this).data("distpicker",new b(this,c))})},a.fn.distpicker.Constructor=b,a(function(){a("[distpicker]").distpicker()})});